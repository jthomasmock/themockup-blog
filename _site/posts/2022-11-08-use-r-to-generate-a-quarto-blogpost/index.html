<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.242">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Tom Mock">
<meta name="dcterms.date" content="2022-11-08">
<meta name="description" content="The {cli} and {fs} packages make life easy!">
<title>The MockUp - Use R to generate a Quarto blogpost</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../themockup.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="The MockUp - Use R to generate a Quarto blogpost">
<meta property="og:description" content="The {cli} and {fs} packages make life easy!">
<meta property="og:image" content="https://themockup.blog/posts/2022-11-08-use-r-to-generate-a-quarto-blogpost/preview.png">
<meta property="og:site-name" content="The MockUp">
<meta property="og:image:height" content="1812">
<meta property="og:image:width" content="3340">
<meta name="twitter:title" content="The MockUp - Use R to generate a Quarto blogpost">
<meta name="twitter:description" content="The {cli} and {fs} packages make life easy!">
<meta name="twitter:image" content="https://raw.githubusercontent.com/jthomasmock/themockup-blog/master/posts/2022-11-08-use-r-to-generate-a-quarto-blogpost/preview.png">
<meta name="twitter:creator" content="@thomas_mock">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="floating nav-fixed slimcontent">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">The MockUp</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../static/resources/resources.html">
 <span class="menu-text">Resources</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/jthomasmock"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/thomas_mock"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://fosstodon.org/@thomas_mock"><i class="bi bi-mastodon" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"><i class="bi bi-rss" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://jthomasmock.github.io/gtExtras/"><i class="bi bi-table" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://drinksbytom.com"><i class="bi bi-cup-straw" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
<div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Use R to generate a Quarto blogpost</h1>
                  <div>
        <div class="description">
          <p>The {cli} and {fs} packages make life easy!</p>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">meta</div>
                <div class="quarto-category">quarto</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Tom Mock </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">November 8, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#title-of-post" id="toc-title-of-post" class="nav-link active" data-scroll-target="#title-of-post">Title of post</a></li>
  <li><a href="#create-folder" id="toc-create-folder" class="nav-link" data-scroll-target="#create-folder">Create folder</a></li>
  <li>
<a href="#create-blogpost-file-as-index.qmd" id="toc-create-blogpost-file-as-index.qmd" class="nav-link" data-scroll-target="#create-blogpost-file-as-index.qmd">Create blogpost file as <code>index.qmd</code></a>
  <ul class="collapse">
<li><a href="#add-description-and-wrap" id="toc-add-description-and-wrap" class="nav-link" data-scroll-target="#add-description-and-wrap">Add description and wrap</a></li>
  </ul>
</li>
  <li>
<a href="#start-file" id="toc-start-file" class="nav-link" data-scroll-target="#start-file">Start file</a>
  <ul class="collapse">
<li><a href="#build-yaml-core" id="toc-build-yaml-core" class="nav-link" data-scroll-target="#build-yaml-core">Build YAML core</a></li>
  </ul>
</li>
  <li><a href="#write-out-to-the-file" id="toc-write-out-to-the-file" class="nav-link" data-scroll-target="#write-out-to-the-file">Write out to the file</a></li>
  <li><a href="#all-together" id="toc-all-together" class="nav-link" data-scroll-target="#all-together">All together</a></li>
  </ul></nav>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content"><p>I am a Quarto super fan for many reasons, and use Quarto for my personal blog. As such, I wanted to simplify the process of creating new blog posts for myself, so I wrote a quick function to do just that!</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># possible arguments listed below</span>
<span class="va">new_post</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span>
    <span class="va">title</span>, 
    <span class="va">file</span> <span class="op">=</span> <span class="st">"index.qmd"</span>,
    <span class="va">description</span> <span class="op">=</span> <span class="st">""</span>,
    <span class="va">author</span> <span class="op">=</span> <span class="st">"Tom Mock"</span>, 
    <span class="va">date</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>, 
    <span class="va">draft</span> <span class="op">=</span> <span class="cn">FALSE</span>, 
    <span class="va">title_limit</span> <span class="op">=</span> <span class="fl">45</span>,
    <span class="va">open_file</span> <span class="op">=</span> <span class="cn">TRUE</span>
    <span class="op">)</span><span class="op">{</span><span class="va">some_code</span><span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Expand for Full Code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">new_post</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span>
    <span class="va">title</span>, 
    <span class="va">file</span> <span class="op">=</span> <span class="st">"index.qmd"</span>,
    <span class="va">description</span> <span class="op">=</span> <span class="st">""</span>,
    <span class="va">author</span> <span class="op">=</span> <span class="st">"Tom Mock"</span>, 
    <span class="va">date</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>, 
    <span class="va">draft</span> <span class="op">=</span> <span class="cn">FALSE</span>, 
    <span class="va">title_limit</span> <span class="op">=</span> <span class="fl">40</span>,
    <span class="va">open_file</span> <span class="op">=</span> <span class="cn">TRUE</span>
    <span class="op">)</span><span class="op">{</span>

  <span class="co"># convert to kebab case and remove non space or alphanumeric characters</span>
  <span class="va">title_kebab</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html">str_to_lower</a></span><span class="op">(</span><span class="va">title</span><span class="op">)</span> |&gt; 
    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove_all</a></span><span class="op">(</span><span class="st">"[^[:alnum:][:space:]]"</span><span class="op">)</span> |&gt; 
    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="st">" "</span>, <span class="st">"-"</span><span class="op">)</span>
  
  <span class="co"># warn if a very long slug</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="va">title_kebab</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="va">title_limit</span><span class="op">)</span><span class="op">{</span>
    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html">cli_alert_warning</a></span><span class="op">(</span><span class="st">"Warning: Title slug is longer than {.val {title_limit}} characters!"</span><span class="op">)</span>
  <span class="op">}</span>
  
  <span class="co"># generate the slug as draft, prefix with _ which prevents</span>
  <span class="co"># quarto from rendering/recognizing the folder</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">draft</span><span class="op">)</span><span class="op">{</span>
    <span class="va">slug</span> <span class="op">&lt;-</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"posts/_{date}-{title_kebab}"</span><span class="op">)</span>
    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html">cli_alert_info</a></span><span class="op">(</span><span class="st">"Appending a '_' to folder name to avoid render while a draft, remove '_' when finished."</span><span class="op">)</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    <span class="va">slug</span> <span class="op">&lt;-</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"posts/{date}-{title_kebab}"</span><span class="op">)</span>
  <span class="op">}</span>
  
  <span class="co"># create and alert about directory</span>
  <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/create.html">dir_create</a></span><span class="op">(</span>
    path <span class="op">=</span> <span class="va">slug</span>
  <span class="op">)</span>
  <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html">cli_alert_success</a></span><span class="op">(</span><span class="st">"Folder created at {.file {slug}}"</span><span class="op">)</span>
  
  <span class="co"># wrap description at 77 characters</span>
  <span class="va">description</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_wrap.html">str_wrap</a></span><span class="op">(</span><span class="va">description</span>, width <span class="op">=</span> <span class="fl">77</span><span class="op">)</span> |&gt; 
    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="st">"[\n]"</span>, <span class="st">"\n  "</span><span class="op">)</span>
  
  <span class="co"># start generating file</span>
  <span class="va">new_post_file</span> <span class="op">&lt;-</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"{slug}/{file}"</span><span class="op">)</span>
  
  <span class="co"># build yaml core</span>
  <span class="va">new_post_core</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="st">"---"</span>,
    <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">'title: "{title}"'</span><span class="op">)</span>,
    <span class="st">"description: |"</span>,
    <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">'  {description}'</span><span class="op">)</span>,
    <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"author: {author}"</span><span class="op">)</span>,
    <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"date: {date}"</span><span class="op">)</span>
  <span class="op">)</span>
  
  <span class="co"># add draft if draft</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">draft</span><span class="op">)</span><span class="op">{</span>
    <span class="va">new_post_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="va">new_post_core</span>,
      <span class="st">"draft: true"</span>,
      <span class="st">"---\n"</span>
      <span class="op">)</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    <span class="va">new_post_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="va">new_post_core</span>,
      <span class="st">"---\n"</span>
    <span class="op">)</span>
  <span class="op">}</span>
  
  <span class="co"># finalize new post text</span>
  <span class="va">new_post_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span>
    <span class="va">new_post_text</span>,
    collapse <span class="op">=</span> <span class="st">"\n"</span>
    <span class="op">)</span>
  
  <span class="co"># create file and alert</span>
  <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/create.html">file_create</a></span><span class="op">(</span><span class="va">new_post_file</span><span class="op">)</span>
  <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html">cli_alert_success</a></span><span class="op">(</span><span class="st">"File created at {.file {new_post_file}}"</span><span class="op">)</span>
  
  <span class="co"># print new post information</span>
  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="va">new_post_text</span><span class="op">)</span>
  
  <span class="kw">if</span><span class="op">(</span><span class="fu">yesno</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/yesno/man/yesno2.html">yesno2</a></span><span class="op">(</span><span class="st">"Are you ready to write that to disk?"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/writeLines.html">writeLines</a></span><span class="op">(</span>
    text <span class="op">=</span> <span class="va">new_post_text</span>,
    con <span class="op">=</span> <span class="va">new_post_file</span>
    <span class="op">)</span>
  
  <span class="fu">rstudioapi</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/rstudioapi/reference/rstudio-documents.html">documentOpen</a></span><span class="op">(</span><span class="va">new_post_file</span>, line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">new_post_text</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span>
  
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>I used it to write this meta blogpost:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">new_post</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Use R to generate a Quarto blogpost"</span>, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">description =</span> <span class="st">"The {cli} and {fs} package make life easy!"</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">draft =</span> <span class="cn">FALSE</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>✔ Folder created at posts<span class="sc">/</span><span class="dv">2022-11-08</span><span class="sc">-</span>use<span class="sc">-</span>r<span class="sc">-</span>to<span class="sc">-</span>generate<span class="sc">-</span>a<span class="sc">-</span>quarto<span class="sc">-</span>blogpost</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>✔ File created at posts<span class="sc">/</span><span class="dv">2022-11-08</span><span class="sc">-</span>use<span class="sc">-</span>r<span class="sc">-</span>to<span class="sc">-</span>generate<span class="sc">-</span>a<span class="sc">-</span>quarto<span class="sc">-</span>blogpost<span class="sc">/</span>index.qmd</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="sc">---</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>title<span class="sc">:</span> <span class="st">"Use R to generate a Quarto blogpost"</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>description<span class="sc">:</span> <span class="er">|</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  The {cli} and {fs} package make life easy<span class="sc">!</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>author<span class="sc">:</span> Tom Mock</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>date<span class="sc">:</span> <span class="dv">2022-11-08</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="sc">---</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This function generates the core skeleton of a Quarto post, including the directory, the <code>index.qmd</code> and writes out some boilerplate information.</p>
<p>We’ll use a few packages to get this done.</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org">stringr</a></span><span class="op">)</span> <span class="co"># easy string manipulation</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidyverse/glue">glue</a></span><span class="op">)</span>    <span class="co"># easy adding of string together</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://fs.r-lib.org">fs</a></span><span class="op">)</span>      <span class="co"># easy file manipulation</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://cli.r-lib.org">cli</a></span><span class="op">)</span>     <span class="co"># easy and beautiful messages/warnings</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/poissonconsulting/yesno">yesno</a></span><span class="op">)</span>   <span class="co"># easy binary decision prompts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="title-of-post" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="title-of-post">Title of post</h2>
<p>For the title, we want to convert a proper title to a kebab case title (<code>kebab-case-like-this</code>), with the date attached as well for easy sorting of folders.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">title</span> <span class="op">&lt;-</span> <span class="st">"Use R to generate a Quarto blogpost"</span>
<span class="co"># convert to kebab case and remove non space or alphanumeric characters</span>
<span class="va">title_kebab</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html">str_to_lower</a></span><span class="op">(</span><span class="va">title</span><span class="op">)</span> |&gt; 
  <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove_all</a></span><span class="op">(</span><span class="st">"[^[:alnum:][:space:]]"</span><span class="op">)</span> |&gt; 
  <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="st">" "</span>, <span class="st">"-"</span><span class="op">)</span>
<span class="va">title_kebab</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "use-r-to-generate-a-quarto-blogpost"</code></pre>
</div>
</div>
<p>We can add a warning with <a href="https://cli.r-lib.org">cli</a> if the title is too long. Too long is subjective, but we can arbitrary say 80 characters. My blog is at <code>https://themockup.blog/posts/</code> and we want to add the date, so we have about 40 characters to work with.</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fl">80</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="st">"https://themockup.blog/posts/2022-11-08-"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 40</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">title_limit</span> <span class="op">&lt;-</span> <span class="fl">40</span>
<span class="co"># we can put that into an if() to add the warning if criterion met</span>
<span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="va">title_kebab</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="va">title_limit</span><span class="op">)</span><span class="op">{</span>
    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html">cli_alert_warning</a></span><span class="op">(</span><span class="st">"Warning: Title slug is longer than {.val {title_limit}} characters!"</span><span class="op">)</span>
<span class="op">}</span>

<span class="co"># we can force it to print like below</span>
<span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html">cli_alert_warning</a></span><span class="op">(</span><span class="st">"Warning: Title slug is longer than {.val {title_limit}} characters!"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>! Warning: Title slug is longer than 40 characters!</code></pre>
</div>
</div>
<div class="page-columns page-full"><p>After that, we can add the date and optionally the draft prefix, files with <code>_</code> at the head are ignored by Quarto. </p><div class="no-row-height column-margin column-container"><span class="">This is largely redundant with the <code>draft: true</code> YAML option - but this safeguards against additional files that could be rendered in that folder.</span></div></div>
<div class="cell">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">draft</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span>
<span class="va">date</span> <span class="op">&lt;-</span> <span class="st">"2022-11-08"</span> <span class="co">#&lt; Sys.Date() for ISO date</span>
<span class="kw">if</span><span class="op">(</span><span class="va">draft</span><span class="op">)</span><span class="op">{</span>
  <span class="va">slug</span> <span class="op">&lt;-</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"posts/_{date}-{title_kebab}"</span><span class="op">)</span>
  <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html">cli_alert_info</a></span><span class="op">(</span><span class="st">"Appending a '_' to folder name to avoid render while a draft, remove '_' when finished."</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="va">slug</span> <span class="op">&lt;-</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"posts/{date}-{title_kebab}"</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">slug</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>posts/2022-11-08-use-r-to-generate-a-quarto-blogpost</code></pre>
</div>
</div>
</section><section id="create-folder" class="level2"><h2 class="anchored" data-anchor-id="create-folder">Create folder</h2>
<p>The folder name is what will end up as the URL “slug”, so we will end up with a url like:</p>
<p><code>https://themockup.blog/posts/2022-11-08-use-r-to-generate-a-quarto-blogpost</code></p>
<div class="cell">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># create and alert about directory</span>
<span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/create.html">dir_create</a></span><span class="op">(</span>
  path <span class="op">=</span> <span class="va">slug</span>
<span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># print alert</span>
<span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html">cli_alert_success</a></span><span class="op">(</span><span class="st">"Folder created at {.file {slug}}"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>✔ Folder created at posts/2022-11-08-use-r-to-generate-a-quarto-blogpost</code></pre>
</section><section id="create-blogpost-file-as-index.qmd" class="level2"><h2 class="anchored" data-anchor-id="create-blogpost-file-as-index.qmd">Create blogpost file as <code>index.qmd</code>
</h2>
<p>We want to name our file <code>index.qmd</code> so that our slug is clean as:</p>
<p><code>https://themockup.blog/posts/2022-11-08-use-r-to-generate-a-quarto-blogpost</code></p>
<p>instead of:</p>
<p><code>https://themockup.blog/posts/2022-11-08-use-r-to-generate-a-quarto-blogpost/some-file.html</code></p>
<section id="add-description-and-wrap" class="level3"><h3 class="anchored" data-anchor-id="add-description-and-wrap">Add description and wrap</h3>
<p>We can take the description and limit the width to &lt;= 80 characters (includes the spacing that YAML needs). We will replace the line breaks <code>\n</code> with leading spaces AND line breaks <code>"  \n"</code> so that the alignment in the YAML is ok.</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">description</span> <span class="op">&lt;-</span> <span class="st">"The {cli} and {fs} package make life easy!"</span>
<span class="co"># wrap description at 77 characters</span>
<span class="va">description</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_wrap.html">str_wrap</a></span><span class="op">(</span><span class="va">description</span>, width <span class="op">=</span> <span class="fl">77</span><span class="op">)</span> |&gt; 
  <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="st">"[\n]"</span>, <span class="st">"\n  "</span><span class="op">)</span>
<span class="va">description</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "The {cli} and {fs} package make life easy!"</code></pre>
</div>
</div>
<p>If the description were long…</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">long_desc</span> <span class="op">&lt;-</span> <span class="st">"  Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum"</span> |&gt; 
  <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_wrap.html">str_wrap</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">77</span><span class="op">)</span> |&gt; 
  <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="st">"[\n]"</span>, <span class="st">"\n  "</span><span class="op">)</span> 

<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"description: |\n  "</span>, <span class="va">long_desc</span><span class="op">)</span>|&gt; 
  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>description: |
  Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod
  tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
  quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
  consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
  cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
  proident, sunt in culpa qui officia deserunt mollit anim id est laborum</code></pre>
</div>
</div>
</section></section><section id="start-file" class="level2"><h2 class="anchored" data-anchor-id="start-file">Start file</h2>
<p>We are using our default <code>index.qmd</code> to again avoid increasing the length of the slug.</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">file</span> <span class="op">&lt;-</span> <span class="st">"index.qmd"</span>
<span class="co"># start generating file</span>
<span class="va">new_post_file</span> <span class="op">&lt;-</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"{slug}/{file}"</span><span class="op">)</span>
<span class="va">new_post_file</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>posts/2022-11-08-use-r-to-generate-a-quarto-blogpost/index.qmd</code></pre>
</div>
</div>
<section id="build-yaml-core" class="level3"><h3 class="anchored" data-anchor-id="build-yaml-core">Build YAML core</h3>
<p>Now we can start building up the YAML, using the <a href="https://github.com/tidyverse/glue">glue</a> package to insert the inputs:</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">author</span> <span class="op">&lt;-</span> <span class="st">"Tom Mock"</span>
<span class="va">new_post_core</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="st">"---"</span>,
  <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">'title: "{title}"'</span><span class="op">)</span>,
  <span class="st">"description: |"</span>,
  <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">'  {description}'</span><span class="op">)</span>,
  <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"author: {author}"</span><span class="op">)</span>,
  <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"date: {date}"</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">new_post_core</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "---"                                           
[2] "title: \"Use R to generate a Quarto blogpost\""
[3] "description: |"                                
[4] "  The {cli} and {fs} package make life easy!"  
[5] "author: Tom Mock"                              
[6] "date: 2022-11-08"                              </code></pre>
</div>
</div>
<p>Optionally adding the <code>draft: true</code> YAML option if needed…</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># add draft if draft</span>
<span class="kw">if</span><span class="op">(</span><span class="va">draft</span><span class="op">)</span><span class="op">{</span>
  <span class="va">new_post_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="va">new_post_core</span>,
    <span class="st">"draft: true"</span>,
    <span class="st">"---\n"</span>
    <span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="va">new_post_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="va">new_post_core</span>,
    <span class="st">"---\n"</span>
  <span class="op">)</span>
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then we throw it all together and collapse with new lines (<code>\n</code>):</p>
<div class="cell">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># finalize new post text</span>
<span class="va">new_post_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span>
  <span class="va">new_post_text</span>,
  collapse <span class="op">=</span> <span class="st">"\n"</span>
  <span class="op">)</span>

<span class="va">new_post_text</span> |&gt; <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>---
title: "Use R to generate a Quarto blogpost"
description: |
  The {cli} and {fs} package make life easy!
author: Tom Mock
date: 2022-11-08
---</code></pre>
</div>
</div>
</section></section><section id="write-out-to-the-file" class="level2"><h2 class="anchored" data-anchor-id="write-out-to-the-file">Write out to the file</h2>
<p>We can create a new file and then write out the YAML, I have this chunk as <code>eval: false</code> right now so that it doesn’t clobber our existing blog post…</p>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/create.html">file_create</a></span><span class="op">(</span><span class="va">new_post_file</span><span class="op">)</span> <span class="co"># &lt;- don't want to recreate it :)</span>
<span class="fu"><a href="https://rdrr.io/r/base/writeLines.html">writeLines</a></span><span class="op">(</span>
  text <span class="op">=</span> <span class="va">new_post_text</span>,
  con <span class="op">=</span> <span class="va">new_post_file</span>
  <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># create file and alert</span>
<span class="co"># fs::file_create(new_post_file) &lt;- don't want to recreate it :)</span>
<span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html">cli_alert_success</a></span><span class="op">(</span><span class="st">"File created at {.file {new_post_file}}"</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>✔ Folder created at posts/2022-11-08-use-r-to-generate-a-quarto-blogpost</code></pre>
<p>Just for funsies we can also print out the raw text using <code><a href="https://rdrr.io/r/base/cat.html">cat()</a></code> to accurately reflect what we’re adding with the new lines and spacing.</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="co"># print new post information</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="va">new_post_text</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>---
title: "Use R to generate a Quarto blogpost"
description: |
  The {cli} and {fs} package make life easy!
author: Tom Mock
date: 2022-11-08
---</code></pre>
</div>
</div>
<p>Then we can have RStudio open the file we just wrote out!</p>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">rstudioapi</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/rstudioapi/reference/rstudio-documents.html">documentOpen</a></span><span class="op">(</span><span class="va">new_post_file</span>, line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">new_post_text</span><span class="op">)</span><span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For safety, we could use the {<code>yesno</code>} package to prompt the user that the <code><a href="https://rdrr.io/r/base/cat.html">cat()</a></code> output looks correct:</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="kw">if</span><span class="op">(</span><span class="fu">yesno</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/yesno/man/yesno2.html">yesno2</a></span><span class="op">(</span><span class="st">"\nDoes that look correct and are you ready to write to disk?"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/writeLines.html">writeLines</a></span><span class="op">(</span>
    text <span class="op">=</span> <span class="va">new_post_text</span>,
    con <span class="op">=</span> <span class="va">new_post_file</span>
    <span class="op">)</span>
  
  <span class="fu">rstudioapi</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/rstudioapi/reference/rstudio-documents.html">documentOpen</a></span><span class="op">(</span><span class="va">new_post_file</span>, line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">new_post_text</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>yesno::yesno2("\nDoes that look correct and are you ready to write to disk?")
Are you ready to write that to disk?
1: Yes
2: No

Selection: 1
[1] TRUE</code></pre>
</section><section id="all-together" class="level2"><h2 class="anchored" data-anchor-id="all-together">All together</h2>
<p>Putting it all together, we can create a new blogpost rapidly!</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="fu">new_post</span><span class="op">(</span>
  <span class="st">"Use R to generate a Quarto blogpost"</span>, 
  description <span class="op">=</span> <span class="st">"The {cli} and {fs} package make life easy!"</span>,
  draft <span class="op">=</span> <span class="cn">FALSE</span>
  <span class="op">)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code>✔ Folder created at posts/2022-11-08-use-r-to-generate-a-quarto-blogpost
✔ File created at posts/2022-11-08-use-r-to-generate-a-quarto-blogpost/index.qmd
---
title: "Use R to generate a Quarto blogpost"
description: |
  The {cli} and {fs} package make life easy!
author: Tom Mock
date: 2022-11-08
---</code></pre>
<p>The full function!</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span class="va">new_post</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span>
    <span class="va">title</span>, 
    <span class="va">file</span> <span class="op">=</span> <span class="st">"index.qmd"</span>,
    <span class="va">description</span> <span class="op">=</span> <span class="st">""</span>,
    <span class="va">author</span> <span class="op">=</span> <span class="st">"Tom Mock"</span>, 
    <span class="va">date</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>, 
    <span class="va">draft</span> <span class="op">=</span> <span class="cn">FALSE</span>, 
    <span class="va">title_limit</span> <span class="op">=</span> <span class="fl">40</span>,
    <span class="va">open_file</span> <span class="op">=</span> <span class="cn">TRUE</span>
    <span class="op">)</span><span class="op">{</span>

  <span class="co"># convert to kebab case and remove non space or alphanumeric characters</span>
  <span class="va">title_kebab</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html">str_to_lower</a></span><span class="op">(</span><span class="va">title</span><span class="op">)</span> |&gt; 
    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove_all</a></span><span class="op">(</span><span class="st">"[^[:alnum:][:space:]]"</span><span class="op">)</span> |&gt; 
    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="st">" "</span>, <span class="st">"-"</span><span class="op">)</span>
  
  <span class="co"># warn if a very long slug</span>
  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html">nchar</a></span><span class="op">(</span><span class="va">title_kebab</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="va">title_limit</span><span class="op">)</span><span class="op">{</span>
    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html">cli_alert_warning</a></span><span class="op">(</span><span class="st">"Warning: Title slug is longer than {.val {title_limit}} characters!"</span><span class="op">)</span>
  <span class="op">}</span>
  
  <span class="co"># generate the slug as draft, prefix with _ which prevents</span>
  <span class="co"># quarto from rendering/recognizing the folder</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">draft</span><span class="op">)</span><span class="op">{</span>
    <span class="va">slug</span> <span class="op">&lt;-</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"posts/_{date}-{title_kebab}"</span><span class="op">)</span>
    <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html">cli_alert_info</a></span><span class="op">(</span><span class="st">"Appending a '_' to folder name to avoid render while a draft, remove '_' when finished."</span><span class="op">)</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    <span class="va">slug</span> <span class="op">&lt;-</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"posts/{date}-{title_kebab}"</span><span class="op">)</span>
  <span class="op">}</span>
  
  <span class="co"># create and alert about directory</span>
  <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/create.html">dir_create</a></span><span class="op">(</span>
    path <span class="op">=</span> <span class="va">slug</span>
  <span class="op">)</span>
  <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html">cli_alert_success</a></span><span class="op">(</span><span class="st">"Folder created at {.file {slug}}"</span><span class="op">)</span>
  
  <span class="co"># wrap description at 77 characters</span>
  <span class="va">description</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_wrap.html">str_wrap</a></span><span class="op">(</span><span class="va">description</span>, width <span class="op">=</span> <span class="fl">77</span><span class="op">)</span> |&gt; 
    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span><span class="op">(</span><span class="st">"[\n]"</span>, <span class="st">"\n  "</span><span class="op">)</span>
  
  <span class="co"># start generating file</span>
  <span class="va">new_post_file</span> <span class="op">&lt;-</span> <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"{slug}/{file}"</span><span class="op">)</span>
  
  <span class="co"># build yaml core</span>
  <span class="va">new_post_core</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
    <span class="st">"---"</span>,
    <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">'title: "{title}"'</span><span class="op">)</span>,
    <span class="st">"description: |"</span>,
    <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">'  {description}'</span><span class="op">)</span>,
    <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"author: {author}"</span><span class="op">)</span>,
    <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"date: {date}"</span><span class="op">)</span>
  <span class="op">)</span>
  
  <span class="co"># add draft if draft</span>
  <span class="kw">if</span><span class="op">(</span><span class="va">draft</span><span class="op">)</span><span class="op">{</span>
    <span class="va">new_post_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="va">new_post_core</span>,
      <span class="st">"draft: true"</span>,
      <span class="st">"---\n"</span>
      <span class="op">)</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    <span class="va">new_post_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
      <span class="va">new_post_core</span>,
      <span class="st">"---\n"</span>
    <span class="op">)</span>
  <span class="op">}</span>
  
  <span class="co"># finalize new post text</span>
  <span class="va">new_post_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span>
    <span class="va">new_post_text</span>,
    collapse <span class="op">=</span> <span class="st">"\n"</span>
    <span class="op">)</span>
  
  <span class="co"># create file and alert</span>
  <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://fs.r-lib.org/reference/create.html">file_create</a></span><span class="op">(</span><span class="va">new_post_file</span><span class="op">)</span>
  <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_alert.html">cli_alert_success</a></span><span class="op">(</span><span class="st">"File created at {.file {new_post_file}}"</span><span class="op">)</span>
  
  <span class="co"># print new post information</span>
  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="va">new_post_text</span><span class="op">)</span>
  
  <span class="kw">if</span><span class="op">(</span><span class="fu">yesno</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/yesno/man/yesno2.html">yesno2</a></span><span class="op">(</span><span class="st">"Are you ready to write that to disk?"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/writeLines.html">writeLines</a></span><span class="op">(</span>
    text <span class="op">=</span> <span class="va">new_post_text</span>,
    con <span class="op">=</span> <span class="va">new_post_file</span>
    <span class="op">)</span>
  
  <span class="fu">rstudioapi</span><span class="fu">::</span><span class="fu"><a href="https://rstudio.github.io/rstudioapi/reference/rstudio-documents.html">documentOpen</a></span><span class="op">(</span><span class="va">new_post_file</span>, line <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">new_post_text</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span> 
  
<span class="op">}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Expand for Session Info
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>─ Session info ───────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.2.0 (2022-04-22)
 os       macOS Monterey 12.6
 system   aarch64, darwin20
 ui       X11
 language (EN)
 collate  en_US.UTF-8
 ctype    en_US.UTF-8
 tz       America/Chicago
 date     2022-11-08
 pandoc   2.19.2 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/ (via rmarkdown)
 quarto   1.2.242 @ /usr/local/bin/quarto

─ Packages ───────────────────────────────────────────────────────────────────
 package     * version date (UTC) lib source
 cli         * 3.4.1   2022-09-23 [1] CRAN (R 4.2.0)
 fs          * 1.5.2   2021-12-08 [1] CRAN (R 4.2.0)
 glue        * 1.6.2   2022-02-24 [1] CRAN (R 4.2.0)
 sessioninfo * 1.2.2   2021-12-06 [1] CRAN (R 4.2.0)
 stringr     * 1.4.1   2022-08-20 [1] CRAN (R 4.2.0)
 yesno       * 0.1.2   2020-07-10 [1] CRAN (R 4.2.0)

 [1] /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/library

──────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
</div>
</div>
</div>
</div>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><script src="https://utteranc.es/client.js" repo="jthomasmock/themockup-blog" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->



</body></html>