{
  "hash": "ed4717a891c582b1c93a48ac53d1b664",
  "result": {
    "markdown": "---\ntitle: \"Add a logo to your plot\"\ndescription: |\n  Put a bird on it - Portlandia.\nauthor: Thomas Mock\ndate: 01-09-2019\nimage: https://images.pexels.com/photos/1564506/pexels-photo-1564506.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=650&w=940\ncategories:\n  - magick\n  - data visualization\n  - ggplot2\n---\n\n\n\n<iframe src=\"https://giphy.com/embed/l4EpavLlevncK4vsY\" width=\"480\" height=\"270\" frameBorder=\"0\" class=\"giphy-embed\" allowFullScreen></iframe><p><a href=\"https://giphy.com/gifs/portlandia-season-1-episode-2-l4EpavLlevncK4vsY\">via GIPHY</a></p>\n\nIf you missed out on Portlandia, you should take some time to watch this clip of the \"Put a bird on it\" episode.\n\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/iHmLljk2t8M\" frameborder=\"0\" allow=\"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture\" allowfullscreen></iframe>\n\nJust like Bryce and Lisa - we can put birds on anything with the `magick` package from ROpenSci!\n\nSo let's get started putting birds on things!\n\n# Magic with magick!\n\nThe `magick` package is an R interface to the ImageMagick STL, one of the most comprehensive open source image processing libraries. It gives a lot of power to R users, and we'll briefly cover the workflow before getting into our real example. \n\nIf you want a deeper dive on all the features of `magick`, check out their awesome [vignette](https://cran.r-project.org/web/packages/magick/vignettes/intro.html)!\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load the library\nlibrary(magick)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLinking to ImageMagick 6.9.12.3\nEnabled features: cairo, fontconfig, freetype, heic, lcms, pango, raw, rsvg, webp\nDisabled features: fftw, ghostscript, x11\n```\n:::\n\n```{.r .cell-code}\n# \"read\" in an image\ndog <- image_read(\"https://images.pexels.com/photos/1564506/pexels-photo-1564506.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=650&w=940\")\n\nimage_info(dog)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  format width height colorspace matte filesize density\n1   JPEG  1880   1208       sRGB FALSE    87884   72x72\n```\n:::\n:::\n\nWe can see a few things about the r_logo object, it is a .png, it's height and width, filesize, and DPI/density.\n\nWe can also view the image in line.\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(dog)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  format width height colorspace matte filesize density\n1   JPEG  1880   1208       sRGB FALSE    87884   72x72\n```\n:::\n\n::: {.cell-output-display}\n![](add-a-logo-to-your-plot_files/figure-html/unnamed-chunk-2-1.png){width=940}\n:::\n:::\n\nWe also have image manipulation options like `image_rotate`, `image_resize`, all of which are pipeable with the `%>%`.\n\n::: {.cell}\n\n```{.r .cell-code}\ndog %>% \n  image_rotate(30) %>% # rotate 30 degrees\n  image_resize(\"400x400\") %>%  # change size to 400 x 400 pixels\n  image_flop() # flip the image horizontally\n```\n\n::: {.cell-output-display}\n![](add-a-logo-to-your-plot_files/figure-html/unnamed-chunk-3-1.png){width=200}\n:::\n:::\n\nMost importantly we can `put a bird on it`!\n\n::: {.cell}\n\n```{.r .cell-code}\nbird <- image_read(\"https://user-images.githubusercontent.com/29187501/38769895-edae85d0-3fcf-11e8-95f9-bbd530b32771.png\") %>% \n  image_resize(\"150x150\")\n\nimage_composite(dog, bird)\n```\n\n::: {.cell-output-display}\n![](add-a-logo-to-your-plot_files/figure-html/unnamed-chunk-4-1.png){width=940}\n:::\n:::\n\nNow please note where the bird showed up, in the top left corner. We can control the placement of composite images by specifying the offset.\n\n::: {.cell}\n\n```{.r .cell-code}\ndog %>% \n  image_composite(bird, offset = \"+500+1000\")\n```\n\n::: {.cell-output-display}\n![](add-a-logo-to-your-plot_files/figure-html/unnamed-chunk-5-1.png){width=940}\n:::\n:::\n\nNotice that offset reads as x-axis pixels, y-axis pixels, so `\"+500+1000` indicates from the top left corner place the image 500 pixels to the right and 1000 pixels down. \n\nNow that we've been oriented to how the `magick` package works, and had some fun by putting a bird on our lovely Boston Terrier model, let's dive into the real purpose of this post - adding a logo to your `ggplot`!\n\n# Building a ggplot with a logo\n\nIn the exampe I will show below you will have already saved the plot as an image, so we can skip with the normal `ggplot2` code. However, please note  that if you do want to build in some extra whitespace to your plot to save \"space\" for your logo you can do so by changing the margins of your overall plot. You can also add a figure caption with `labs(caption = \"text to change here\")`, which inherently adds some whitespace to incorporate the caption.\n\nMargins can take multiple units arguments including: \"cm\", \"in\", \"lines\", \"pt\", for more info check out the [`ggplot2` docs](https://ggplot2.tidyverse.org/reference/element.html).\n\n**Notice**: The margins read as t, r, b, l or `c(top, right, bottom, left)`. I typically see logos on the bottom left or top right so you can:\n\n* add space at the top for example with:  \n`c(2.5, 0.5, 0.5, 0.5)`\n\n* add space to the bottom with:  \n`c(0.5, 0.5, 2.5, 0.5)`\n\nNotice the below plot has extra space on the bottom, and I have added a grey background purely to highlight this extra space.\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✓ ggplot2 3.3.5     ✓ purrr   0.3.4\n✓ tibble  3.1.6     ✓ dplyr   1.0.8\n✓ tidyr   1.2.0     ✓ stringr 1.4.0\n✓ readr   2.0.2     ✓ forcats 0.5.1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\nx dplyr::filter() masks stats::filter()\nx dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nmtcars %>% \n  ggplot(aes(x = cyl, y = mpg)) +\n  geom_point() +\n  theme(plot.margin = unit(c(0.5, 0.5, 2.5, 0.5), \"lines\"),\n        plot.background = element_rect(\"lightgrey\"))\n```\n\n::: {.cell-output-display}\n![](add-a-logo-to-your-plot_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# plot background = lightgrey for highlight, not necessary for sizing\n```\n:::\n\n## Read in a plot\n\nSo let's read in our publication plot to work with! Please notice that this can be a local file with traditional path structure or a hosted image as a url. I'm using URLs so you can try these out yourself!\n\n::: {.cell}\n\n```{.r .cell-code}\npub_plot <- image_read(\"https://raw.githubusercontent.com/jthomasmock/tomtom/master/vignettes/basic_plot.png\")\n\nlogo <- image_read(\"https://www.rstudio.com/wp-content/uploads/2018/10/RStudio-Logo-Flat.png\") %>% \n  image_resize(300)\n\nprint(pub_plot)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 7\n  format width height colorspace matte filesize density\n  <chr>  <int>  <int> <chr>      <lgl>    <int> <chr>  \n1 PNG     2222   1951 sRGB       TRUE    168897 72x72  \n```\n:::\n\n::: {.cell-output-display}\n![](add-a-logo-to-your-plot_files/figure-html/unnamed-chunk-7-1.png){width=1111}\n:::\n\n```{.r .cell-code}\nprint(logo)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 7\n  format width height colorspace matte filesize density\n  <chr>  <int>  <int> <chr>      <lgl>    <int> <chr>  \n1 PNG      300    105 sRGB       TRUE         0 57x57  \n```\n:::\n\n::: {.cell-output-display}\n![](add-a-logo-to-your-plot_files/figure-html/unnamed-chunk-7-2.png){width=150}\n:::\n:::\n\n## Where to put the logo?\n\nWe can then overlay the logo over the plot, let's try bottom left, and we want ~ 1% padding for aesthetics - so we can use the following code to get dimensions and pixel numbers.\n\n::: {.cell}\n\n```{.r .cell-code}\n# get dims of the plot\nplot_height <- magick::image_info(pub_plot)$height\nplot_width <- magick::image_info(pub_plot)$width\n\n# get dims of the logo\nlogo_width <- magick::image_info(logo)$width\nlogo_height <- magick::image_info(logo)$height\n\n# get number of pixels to be 1% from the bottom of the plot\n# while accounting for the logo height\nplot_height - logo_height - plot_height * 0.01\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1826.49\n```\n:::\n\n```{.r .cell-code}\n# get number of pixels to be 1% from the left of the plot\nplot_width * 0.01\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 22.22\n```\n:::\n:::\n\n## Add the logo\n\nBy using `offset = \"+22+1826\"` we indicate that we are placing the logo 22 pixels to the right and 1826 pixels down.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npub_plot %>% \n  image_composite(logo, offset = \"+22+1826\")\n```\n\n::: {.cell-output-display}\n![](add-a-logo-to-your-plot_files/figure-html/unnamed-chunk-9-1.png){width=1111}\n:::\n:::\n\nBoom! We have our logo overlay on the plot in the right location! But we had to manually figure out and set the logo position, which is less than ideal for programmatic use down the road. I also manually resized the logo to 300 pixels in an earlier step - we should make that automagick as well!\n\n## Put it in a function! (Bird not included)\n\nTo make the logo add process more reproducible, we can build a function to take the various heights and widths of the logo/plot and automatically resize the logo to match as well as calculating the number of pixels to put it in each respective corner. The logo_scale argument defaults to 10 - so the logo will be 1/10th the width of the plot.\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_with_logo <- add_logo(\n  plot_path = \"\", # url or local file for the plot\n  logo_path = \"\", # url or local file for the logo\n  logo_position = \"\" # choose a corner\n  # 'top left', 'top right', 'bottom left' or 'bottom right'\n  #logo_scale = 10 as default, but can change to manually make logo bigger\n)\n\n# save the image and write to working directory\nmagick::image_write(plot_with_logo, \"plot_with_logo.png\")\n```\n:::\n\n## The function details\n\nThis function takes in two images, gets the dimension information, then pastes the logo at 1/10th scale in the specified corner with 1% padding. The function also has a warning if you input a `logo_position` that is not included.\n\n::: {.cell}\n\n```{.r .cell-code}\nadd_logo <- function(plot_path, logo_path, logo_position, logo_scale = 10){\n\n    # Requires magick R Package https://github.com/ropensci/magick\n\n    # Useful error message for logo position\n    if (!logo_position %in% c(\"top right\", \"top left\", \"bottom right\", \"bottom left\")) {\n        stop(\"Error Message: Uh oh! Logo Position not recognized\\n  Try: logo_positon = 'top left', 'top right', 'bottom left', or 'bottom right'\")\n    }\n\n    # read in raw images\n    plot <- magick::image_read(plot_path)\n    logo_raw <- magick::image_read(logo_path)\n\n    # get dimensions of plot for scaling\n    plot_height <- magick::image_info(plot)$height\n    plot_width <- magick::image_info(plot)$width\n\n    # default scale to 1/10th width of plot\n    # Can change with logo_scale\n    logo <- magick::image_scale(logo_raw, as.character(plot_width/logo_scale))\n\n    # Get width of logo\n    logo_width <- magick::image_info(logo)$width\n    logo_height <- magick::image_info(logo)$height\n\n    # Set position of logo\n    # Position starts at 0,0 at top left\n    # Using 0.01 for 1% - aesthetic padding\n\n    if (logo_position == \"top right\") {\n        x_pos = plot_width - logo_width - 0.01 * plot_width\n        y_pos = 0.01 * plot_height\n    } else if (logo_position == \"top left\") {\n        x_pos = 0.01 * plot_width\n        y_pos = 0.01 * plot_height\n    } else if (logo_position == \"bottom right\") {\n        x_pos = plot_width - logo_width - 0.01 * plot_width\n        y_pos = plot_height - logo_height - 0.01 * plot_height\n    } else if (logo_position == \"bottom left\") {\n        x_pos = 0.01 * plot_width\n        y_pos = plot_height - logo_height - 0.01 * plot_height\n    }\n\n    # Compose the actual overlay\n    magick::image_composite(plot, logo, offset = paste0(\"+\", x_pos, \"+\", y_pos))\n\n}\n```\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](add-a-logo-to-your-plot_files/figure-html/unnamed-chunk-12-1.png){width=1111}\n:::\n:::\n\n\nSo there you go! Happy logo adding and bird putting! \n\nFor more information on adding logos to plots with `magick::image_append()` instead, check out this [blog post](https://www.danielphadley.com/ggplot-logo/) by Daniel Hadley on using `magick::image_append` to add a logo or his [RStudioConf](https://resources.rstudio.com/rstudio-conf-2018/branding-and-automating-your-work-with-r-markdown-daniel-hadley) talk on the same idea.\n\nCheers!\n\n![](https://images.pexels.com/photos/1564506/pexels-photo-1564506.jpeg?auto=compress&cs=tinysrgb&dpr=2&h=650&w=940)\n\n\n:::{.callout-tip collapse=\"true\"}\n## Expand for Session Info\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.1.1 (2021-08-10)\n os       macOS Monterey 12.2.1\n system   aarch64, darwin20\n ui       X11\n language (EN)\n collate  en_US.UTF-8\n ctype    en_US.UTF-8\n tz       America/Chicago\n date     2022-04-25\n pandoc   2.18 @ /Applications/RStudio.app/Contents/MacOS/quarto/bin/tools/ (via rmarkdown)\n quarto   0.9.294 @ /usr/local/bin/quarto\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package     * version date (UTC) lib source\n dplyr       * 1.0.8   2022-02-08 [1] CRAN (R 4.1.1)\n forcats     * 0.5.1   2021-01-27 [1] CRAN (R 4.1.1)\n ggplot2     * 3.3.5   2021-06-25 [1] CRAN (R 4.1.1)\n magick      * 2.7.3   2021-08-18 [1] CRAN (R 4.1.1)\n purrr       * 0.3.4   2020-04-17 [1] CRAN (R 4.1.0)\n readr       * 2.0.2   2021-09-27 [1] CRAN (R 4.1.1)\n sessioninfo * 1.2.2   2021-12-06 [1] CRAN (R 4.1.1)\n stringr     * 1.4.0   2019-02-10 [1] CRAN (R 4.1.1)\n tibble      * 3.1.6   2021-11-07 [1] CRAN (R 4.1.1)\n tidyr       * 1.2.0   2022-02-01 [1] CRAN (R 4.1.1)\n tidyverse   * 1.3.1   2021-04-15 [1] CRAN (R 4.1.0)\n\n [1] /Library/Frameworks/R.framework/Versions/4.1-arm64/Resources/library\n\n──────────────────────────────────────────────────────────────────────────────\n```\n:::\n:::\n\n:::\n",
    "supporting": [
      "add-a-logo-to-your-plot_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}